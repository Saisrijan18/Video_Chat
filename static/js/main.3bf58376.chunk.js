(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{154:function(e,t,n){},155:function(e,t,n){},156:function(e,t,n){},188:function(e,t){},190:function(e,t){},205:function(e,t,n){},211:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),s=n(19),i=n.n(s),o=(n(154),n(155),n(140)),r=n(16),l=n(89),u=n(15),d=Object(c.createContext)(),j=(n(156),n(214)),b=n(149),m=n(216),f=n(215),h=(n.p,n.p+"static/media/video.e038b670.svg"),O=n(102),g=n.p+"static/media/video-off.81281c31.svg",v=n.p+"static/media/msg_illus.a7fd59ce.svg",p=n.p+"static/media/msg.590bd963.svg",x=n.p+"static/media/share_screen.2998de9b.svg",y=n(217),C=n(218),S=n(103),_=n.n(S),w=n(143),k=n(4),N=Object(O.io)("https://fathomless-tundra-67025.herokuapp.com/"),M=function(e){var t=e.children,n=Object(c.useState)(!1),a=Object(u.a)(n,2),s=a[0],i=a[1],o=Object(c.useState)(!1),r=Object(u.a)(o,2),j=r[0],b=r[1],m=Object(c.useState)(),f=Object(u.a)(m,2),h=f[0],O=f[1],g=Object(c.useState)([]),v=Object(u.a)(g,2),p=v[0],x=v[1],y=Object(c.useState)(""),C=Object(u.a)(y,2),S=C[0],M=C[1],R=Object(c.useState)({}),I=Object(u.a)(R,2),T=I[0],V=I[1],A=Object(c.useState)(""),U=Object(u.a)(A,2),E=U[0],D=U[1],F=Object(c.useState)(""),W=Object(u.a)(F,2),q=W[0],z=W[1],B=Object(c.useState)(""),P=Object(u.a)(B,2),L=P[0],J=P[1],H=Object(c.useState)(!0),G=Object(u.a)(H,2),X=G[0],Y=G[1],K=Object(c.useState)(),Q=Object(u.a)(K,2),Z=Q[0],$=Q[1],ee=Object(c.useState)(!0),te=Object(u.a)(ee,2),ne=te[0],ce=te[1],ae=Object(c.useState)(),se=Object(u.a)(ae,2),ie=se[0],oe=se[1],re=Object(c.useState)(""),le=Object(u.a)(re,2),ue=le[0],de=le[1],je=Object(c.useState)(!1),be=Object(u.a)(je,2),me=be[0],fe=be[1],he=Object(c.useRef)(),Oe=Object(c.useRef)(),ge=Object(c.useRef)(),ve=Object(c.useRef)();Object(c.useEffect)((function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){O(e),he.current.srcObject=e})),localStorage.getItem("name")&&M(localStorage.getItem("name")),N.on("me",(function(e){return D(e)})),N.on("endCall",(function(){window.location.reload()})),N.on("updateUserMedia",(function(e){var t=e.type,n=e.currentMediaStatus;if(null!==n||n!==[])switch(t){case"video":$(n);break;case"mic":oe(n);break;default:oe(n[0]),$(n[1])}})),N.on("callUser",(function(e){var t=e.from,n=e.name,c=e.signal;V({isReceivingCall:!0,from:t,name:n,signal:c})})),N.on("msgRcv",(function(e){e.name;var t=e.msg,n=e.sender;de({value:t,sender:n}),setTimeout((function(){de({})}),2e3)}))}),[]);return Object(k.jsx)(d.Provider,{value:{call:T,callAccepted:s,myVideo:he,userVideo:Oe,stream:h,name:S,setName:M,callEnded:j,me:E,callUser:function(e){var t=new _.a({initiator:!0,trickle:!1,stream:h});J(e),t.on("signal",(function(t){N.emit("callUser",{userToCall:e,signalData:t,from:E,name:S})})),t.on("stream",(function(e){Oe.current.srcObject=e})),N.on("callAccepted",(function(e){var n=e.signal,c=e.userName;i(!0),z(c),t.signal(n),N.emit("updateMyMedia",{type:"both",currentMediaStatus:[ne,X]})})),ge.current=t,console.log(ge.current)},leaveCall:function(){b(!0),ge.current.destroy(),N.emit("endCall",{id:L}),window.location.reload()},answerCall:function(){i(!0),J(T.from);var e=new _.a({initiator:!1,trickle:!1,stream:h});e.on("signal",(function(e){N.emit("answerCall",{signal:e,to:T.from,userName:S,type:"both",myMediaStatus:[ne,X]})})),e.on("stream",(function(e){Oe.current.srcObject=e})),e.signal(T.signal),ge.current=e,console.log(ge.current)},sendMsg:function(e){N.emit("msgUser",{name:S,to:L,msg:e,sender:S});var t={};t.msg=e,t.type="sent",t.timestamp=Date.now(),t.sender=S,x([].concat(Object(l.a)(p),[t]))},msgRcv:ue,chat:p,setChat:x,setMsgRcv:de,setOtherUser:J,leaveCall1:function(){N.emit("endCall",{id:L})},userName:q,myVdoStatus:X,setMyVdoStatus:Y,userVdoStatus:Z,setUserVdoStatus:$,updateVideo:function(){Y((function(e){return N.emit("updateMyMedia",{type:"video",currentMediaStatus:!e}),h.getVideoTracks()[0].enabled=!e,!e}))},myMicStatus:ne,userMicStatus:ie,updateMic:function(){ce((function(e){return N.emit("updateMyMedia",{type:"mic",currentMediaStatus:!e}),h.getAudioTracks()[0].enabled=!e,!e}))},screenShare:me,handleScreenSharing:function(){X?me?ve.current.onended():navigator.mediaDevices.getDisplayMedia({cursor:!0}).then((function(e){var t=e.getTracks()[0];ge.current.replaceTrack(ge.current.streams[0].getTracks().find((function(e){return"video"===e.kind})),t,h),t.onended=function(){ge.current.replaceTrack(t,ge.current.streams[0].getTracks().find((function(e){return"video"===e.kind})),h),he.current.srcObject=h,fe(!1)},he.current.srcObject=e,ve.current=t,fe(!0)})).catch((function(e){console.log("No stream for sharing")})):w.b.error("Turn on your video to share the content",2)},fullScreen:function(e){var t=e.target;t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}},children:t})},R=j.a.Search,I=function(){var e=Object(c.useContext)(d),t=e.call,n=e.callAccepted,a=e.myVideo,s=e.userVideo,i=e.stream,o=e.name,r=(e.setName,e.callEnded),j=(e.me,e.callUser,e.leaveCall,e.answerCall,e.sendMsg),O=e.msgRcv,S=e.chat,_=e.setChat,w=e.userName,M=e.myVdoStatus,I=(e.screenShare,e.fullScreen),T=e.handleScreenSharing,V=e.userVdoStatus,A=e.updateVideo,U=e.myMicStatus,E=e.userMicStatus,D=e.updateMic,F=Object(c.useState)(""),W=Object(u.a)(F,2),q=W[0],z=W[1],B=Object(c.useState)(!1),P=Object(u.a)(B,2),L=P[0],J=P[1];N.on("msgRcv",(function(e){e.name;var t=e.msg,n=e.sender,c={};c.msg=t,c.type="rcv",c.sender=n,c.timestamp=Date.now(),_([].concat(Object(l.a)(S),[c]))}));var H=Object(c.useRef)();Object(c.useEffect)((function(){(null===H||void 0===H?void 0:H.current)&&H.current.scrollIntoView({behavior:"smooth"})}),[S]);var G=function(e){J(e)};return Object(c.useEffect)((function(){O.value&&!L&&b.a.open({message:"",description:"".concat(O.sender,": ").concat(O.value),icon:Object(k.jsx)(y.a,{style:{color:"#108ee9"}})})}),[O]),Object(k.jsxs)("div",{className:"grid",children:[i?Object(k.jsxs)("div",{style:{textAlign:"center"},className:"card",id:n&&!r?"video1":"video3",children:[Object(k.jsx)("div",{style:{height:"2rem"},children:Object(k.jsx)("h3",{children:M&&o})}),Object(k.jsxs)("div",{className:"video-avatar-container",children:[Object(k.jsx)("video",{playsInline:!0,muted:!0,onClick:I,ref:a,autoPlay:!0,className:"video-active",style:{opacity:"".concat(M?"1":"0")}}),Object(k.jsx)(m.a,{style:{backgroundColor:"#116",position:"absolute",opacity:"".concat(M?"-1":"2")},size:98,icon:!o&&Object(k.jsx)(C.a,{}),children:o})]}),Object(k.jsxs)("div",{className:"iconsDiv",children:[Object(k.jsx)("div",{className:"icons",onClick:function(){D()},tabIndex:"0",children:Object(k.jsx)("i",{className:"fa fa-microphone".concat(U?"":"-slash"),style:{transform:"scaleX(-1)"},"aria-label":"".concat(U?"mic on":"mic off"),"aria-hidden":"true"})}),n&&!r&&Object(k.jsx)("div",{className:"icons",onClick:function(){J(!L)},tabIndex:"0",children:Object(k.jsx)("img",{src:p,alt:"chat icon"})}),Object(k.jsxs)(f.a,{title:"Chat",footer:null,visible:L,onOk:function(){return G(!1)},onCancel:function(){return G(!1)},style:{maxHeight:"100px"},children:[S.length?Object(k.jsxs)("div",{className:"msg_flex",children:[S.map((function(e){return Object(k.jsx)("div",{className:"sent"===e.type?"msg_sent":"msg_rcv",children:e.msg})})),Object(k.jsx)("div",{ref:H,id:"no_border"})]}):Object(k.jsx)("div",{className:"chat_img_div",children:Object(k.jsx)("img",{src:v,alt:"msg_illus",className:"img_illus"})}),Object(k.jsx)(R,{placeholder:"your message",allowClear:!0,className:"input_msg",enterButton:"Send \ud83d\ude80",onChange:function(e){return z(e.target.value)},value:q,size:"large",onSearch:function(e){e&&e.length&&j(e),z("")}})]}),n&&!r&&Object(k.jsx)("div",{className:"icons",onClick:function(){return T()},tabIndex:"0",children:Object(k.jsx)("img",{src:x,alt:"share screen"})}),Object(k.jsx)("div",{className:"icons",onClick:function(){return A()},tabIndex:"0",children:M?Object(k.jsx)("img",{src:h,alt:"video on icon"}):Object(k.jsx)("img",{src:g,alt:"video off icon"})})]})]}):Object(k.jsxs)("div",{className:"bouncing-loader",children:[Object(k.jsx)("div",{}),Object(k.jsx)("div",{}),Object(k.jsx)("div",{})]}),n&&!r&&s&&Object(k.jsxs)("div",{className:"card2",style:{textAlign:"center"},id:"video2",children:[Object(k.jsx)("div",{style:{height:"2rem"},children:Object(k.jsx)("h3",{children:V&&(t.name||w)})}),Object(k.jsxs)("div",{className:"video-avatar-container",children:[Object(k.jsx)("video",{playsInline:!0,ref:s,onClick:I,autoPlay:!0,className:"video-active",style:{opacity:"".concat(V?"1":"0")}}),Object(k.jsx)(m.a,{style:{backgroundColor:"#116",position:"absolute",opacity:"".concat(V?"-1":"2")},size:98,icon:!(w||t.name)&&Object(k.jsx)(C.a,{}),children:w||t.name}),!E&&Object(k.jsx)("i",{style:{position:"absolute",top:"0",left:"0",padding:"0.3rem",backgroundColor:"#fefefebf"},className:"fad fa-volume-mute fa-2x","aria-hidden":"true","aria-label":"microphone muted"})]})]})]})},T=n(48),V=n(146),A=n.p+"static/media/phone.b2c1ae6b.gif",U=n.p+"static/media/teams.23d1d865.mp3",E=n(30),D=n(139),F=n.p+"static/media/hang.a09ef7b4.svg",W=n(219),q=n(92),z=n(220),B=function(){var e=Object(c.useState)(""),t=Object(u.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(!1),i=Object(u.a)(s,2),o=i[0],r=i[1],l=Object(c.useRef)(),b=Object(c.useContext)(d),m=b.call,h=b.callAccepted,O=(b.myVideo,b.userVideo,b.stream,b.name),g=b.setName,v=b.callEnded,p=b.me,x=b.callUser,y=b.leaveCall,S=b.answerCall,_=(b.otherUser,b.setOtherUser),N=b.leaveCall1;Object(c.useEffect)((function(){var e,t;o?null===l||void 0===l||null===(t=l.current)||void 0===t||t.play():null===l||void 0===l||null===(e=l.current)||void 0===e||e.pause()}),[o]);return Object(c.useEffect)((function(){m.isReceivingCall&&!h?(r(!0),_(m.from)):r(!1)}),[m.isReceivingCall]),Object(k.jsxs)("div",{className:E.options,children:[Object(k.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[Object(k.jsx)("h2",{children:"Account Info"}),Object(k.jsx)(j.a,{size:"large",placeholder:"Your name",prefix:Object(k.jsx)(C.a,{}),maxLength:15,suffix:Object(k.jsxs)("small",{children:[O.length,"/15"]}),value:O,onChange:function(e){g(e.target.value),localStorage.setItem("name",e.target.value)},className:E.inputgroup}),Object(k.jsx)("div",{className:E.share_options,children:Object(k.jsx)(D.CopyToClipboard,{text:p,children:Object(k.jsx)(T.a,{type:"primary",icon:Object(k.jsx)(W.a,{}),className:E.btn,tabIndex:"0",onClick:function(){return w.b.success("Code copied successfully!")},children:"Copy code"})})})]}),Object(k.jsxs)("div",{style:{marginBottom:"0.5rem"},children:[Object(k.jsx)("h2",{children:"Make a call"}),Object(k.jsx)(j.a,{placeholder:"Enter code to call",size:"large",className:E.inputgroup,value:n,onChange:function(e){return a(e.target.value)},style:{marginRight:"0.5rem",marginBottom:"0.5rem"},prefix:Object(k.jsx)(C.a,{className:"site-form-item-icon"}),suffix:Object(k.jsx)(V.a,{title:"Enter code of the other user",children:Object(k.jsx)(q.a,{style:{color:"rgba(0,0,0,.45)"}})})}),h&&!v?Object(k.jsxs)(T.a,{variant:"contained",onClick:y,className:E.hang,tabIndex:"0",children:[Object(k.jsx)("img",{src:F,alt:"hang up",style:{height:"15px"}}),"\xa0 Hang up"]}):Object(k.jsx)(T.a,{type:"primary",icon:Object(k.jsx)(z.a,{}),onClick:function(){O.length?x(n):w.b.error("Please enter your name to call!")},className:E.btn,tabIndex:"0",children:"Call"})]}),m.isReceivingCall&&!h&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("audio",{src:U,loop:!0,ref:l}),Object(k.jsxs)(f.a,{title:"Incoming Call",visible:o,onOk:function(){r(!1)},onCancel:function(){r(!1),N(),window.location.reload()},footer:null,children:[Object(k.jsx)("div",{style:{display:"flex",justifyContent:"space-around"},children:Object(k.jsxs)("h1",{children:[m.name," is calling you:"," ",Object(k.jsx)("img",{src:A,alt:"phone ringing",className:E.phone,style:{display:"inline-block"}})]})}),Object(k.jsxs)("div",{className:E.btnDiv,children:[Object(k.jsx)(T.a,{variant:"contained",className:E.answer,color:"#29bb89",icon:Object(k.jsx)(z.a,{}),onClick:function(){S(),l.current.pause()},tabIndex:"0",children:"Answer"}),Object(k.jsx)(T.a,{variant:"contained",className:E.decline,icon:Object(k.jsx)(z.a,{}),onClick:function(){r(!1),l.current.pause()},tabIndex:"0",children:"Decline"})]})]})]})]})},P=n(221),L=(n(205),function(){return Object(k.jsxs)("footer",{className:"footer",children:["Made with ",Object(k.jsx)(P.a,{twoToneColor:"#eb2f96"})," By"," ",Object(k.jsx)("a",{className:"footer__link",href:"https://github.com/Saisrijan18",target:"_blank",style:{color:"#fdfdfd"},rel:"noreferrer",children:"Saisrijan"})]})}),J=function(){return Object(c.useEffect)((function(){navigator.onLine||alert("Connect to internet!")}),[navigator]),Object(c.useEffect)((function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var n=e[t],c=n.indexOf("="),a=c>-1?n.substr(0,c):n;document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}),[]),Object(k.jsx)(M,{children:Object(k.jsxs)("div",{className:"App",style:{height:"100%",width:"100%"},children:[Object(k.jsx)(I,{}),Object(k.jsx)(B,{})]})})},H=(n(206),n(207),function(){return Object(k.jsxs)(o.a,{children:[Object(k.jsx)(r.c,{children:Object(k.jsx)(r.a,{path:"/",component:J})}),Object(k.jsx)(L,{})]})}),G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,222)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),s(e),i(e)}))},X=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Y(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(Object(k.jsx)(a.a.StrictMode,{children:Object(k.jsx)(H,{})}),document.getElementById("root")),G(),function(e){if("serviceWorker"in navigator){if(new URL("/Video_Chat",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/Video_Chat","/service-worker.js");X?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var c=n.headers.get("content-type");404===n.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Y(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Y(t,e)}))}}()},30:function(e,t,n){e.exports={options:"Options_options__2a7vD",btn:"Options_btn__2KmHI",inputgroup:"Options_inputgroup__2WN0b",btnDiv:"Options_btnDiv__165LZ",phone:"Options_phone__18c5s",answer:"Options_answer__2bG95",decline:"Options_decline__3U1Sz",hang:"Options_hang__15CYn",share_options:"Options_share_options__2cAQ4",share_social:"Options_share_social__J39v5",share_icon:"Options_share_icon__2uhXv"}}},[[211,1,2]]]);
//# sourceMappingURL=main.3bf58376.chunk.js.map